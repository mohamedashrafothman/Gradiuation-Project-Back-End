extends ../../layouts/layout.pug

block content
	.col-md-12.grid-margin.stretch-card
		.card
			.card-body
				h3.card-title.mb-1= title
				h5.card-description.text-muted.mb-5
					| Edit Your information.
				form.forms-sample.row(action=`/dashboard/profile/${user.slug}/edit?_csrf=${csrfToken()}`, method="POST", enctype="multipart/form-data")
					input(type="hidden", name="_csrf", value=`${csrfToken()}`)
					.form-label-group.col-md-4
						input#name.form-control.form-control-lg(type='text', placeholder='Name', value=(user != undefined ? user.name : '') , name="name" required)
						label.ml-3(for='name') Name
					.form-label-group.col-md-4
						input#email.form-control.form-control-lg(type='email', placeholder='Email', name="contacts[email]", value=(user.contacts != undefined ? user.contacts.email : ''))
						label.ml-3(for='email') Email address
					.form-label-group.col-md-4
						input#mobileNumber.form-control.form-control-lg(type='text', name="contacts[mobileNumber]", value=(user.contacts != undefined ? user.contacts.mobileNumber : ''), placeholder='Mobile number')
						label.ml-3(for='mobileNumber') Mobile Number
					.form-label-group.col-md-4
						input#website.form-control.form-control-lg(type='text', name="contacts[website]", value=(user.contacts != undefined ? user.contacts.website : ''), placeholder='Website')
						label.ml-3(for='website') Website
					.form-group.col-md-12
						label(for="required-papers") Required Papers
						input.form-control.form-control-lg.selectePapers(type='text', placeholder="Required Papers.")
						input.invisible.w-122(type="hidden", name="required_papers", value="", id="required-papers")
					.form-group.col-md-12
						input.file-upload-default(type='file', name='photo', id="photo", accept="image/gif, image/png, image/jpeg")
						label Image
						.input-group.col-xs-12(style="z-index:0;")
							input.form-control.file-upload-info.form-control-lg(type='file', name='photo', id="photo", accept="image/gif, image/png, image/jpeg", placeholder="Upload image")
							span.input-group-btn
								button.file-upload-browse.btn.btn-info(type='button') Upload
					if user.photo
						.form-group.col-md-12.text-center
							img.mb-2.mw-50.w-50.rounded(src=`/img/uploads/${user.photo}`, alt=`${user.photo}`)

					.form-label-group.col-md-12
						input#autocomplete.form-control.form-control-lg(type='text', placeholder='Address', name="location[address]", value=(user.location && user.location.address) required)
						label.ml-3(for='address') Address
					.form-label-group.col-md-6
						input#lng.form-control.form-control-lg(type='text', placeholder='Lng', name="location[coordinates][0]", value=(user.location && user.location.coordinates[0]) required readonly)
						label.ml-3(for='lng') Address Lng
					.form-label-group.col-md-6
						input#lat.form-control.form-control-lg(type='text', placeholder='Lat', name="location[coordinates][1]", value=(user.location && user.location.coordinates[1]) required readonly)
						label.ml-3(for='lat') Address Lat
					.form-label-group.col-md-6
						input#city.form-control.form-control-lg(type='text', placeholder='City', name="location[city]", value=(user.location && user.location.city) required)
						label.ml-3(for='city') Address City
					.form-label-group.col-md-6
						input#country.form-control.form-control-lg(type='text', placeholder='Country', name="location[country]", value=(user.location && user.location.country) required)
						label.ml-3(for='country') Address Country

					.form-group.col-md-12
						label(for='description') Description
						textarea#description.form-control.form-control-lg(rows='5', name="description" required)=user.description 
					.form-group.col-md-4
						button.btn.btn-success.btn-lg.mr-2(type='submit') Submit
				script.
					(function(){
						var eventLog = function (ctx, e) {
							var html = [
								"name: " + ctx.get("name"),
								"event.type: " + e.type,
								"val: " + ctx[0]
							];
							// $(".events-plate").html(html.join("<br />"));
							// console.log(html.join());
						};
						var valuesArr = [];
						$(".selectePapers").mSelectDBox({
							"list": ['البطاقة الشخصية للمتقدم سارية', 'عدد 6 صور شخصية للمتقدم', 'جواز سفر ممغنط ساري لمدة عام علي الأقل', 'النساء أقل من عمر 45 لابد من اصطحاب معها محرم من احد الأقارب ومن تجاوز 45 عاماً بأمكانهن السفر بمفردهن', 'الشهادة الصحية قبل الذهاب إلي العمرة', 'أصل شهادة الميلاد','الموقف من التجنيد لمن هم دون سن التجنيد'],
							"multiple": true,
							"autoComplete": true,
							"width": "100%",
							"name": "a",
							"onInit": function (ctx) {
								new $.fn.mSelectDBox.MyCustomAppear1(ctx);
							},
							"input:empty": eventLog,
							"onselect": function (msdbContext) {
								var values = msdbContext._props.target.attributes['data-msdb-value'].value;
								valuesArr = $(".selectePapers").mSelectDBox().getSelectedValues();
								var input = $('#required-papers');
								$(input).val(valuesArr);
							}
						});
					})();